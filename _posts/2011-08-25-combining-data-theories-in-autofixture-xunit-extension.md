---
layout : basic
title  : Combining Data Theories in AutoFixture.Xunit extension
summary: The implementation of the legendary InlineAutoData attribute
id-image: 1
tags:
    - AutoFixture
    - xUnit.net
---

[xUnit.net](http://xunit.codeplex.com/ "xUnit.net is a unit testing tool for the .NET Framework. Written by the original inventor of NUnit.")
supports parameterized tests via *data theories*:

``` csharp
public class ParameterizedTests
{
    public bool IsOddNumber(int number)
    {
        return number % 2 != 0;
    }

    [Theory]
    [InlineData(5, 1, 3, 9)]
    [InlineData(7, 1, 5, 3)]
    public void AllNumbers_AreOdd_WithInlineData(int a, int b, int c, int d)
    {
        Assert.True(IsOddNumber(a));
        Assert.True(IsOddNumber(b));
        Assert.True(IsOddNumber(c));
        Assert.True(IsOddNumber(d));
    }
}
```

The above example can be found in
[Hamid Mosalla](https://hamidmosalla.com/)'s
post
[xUnit Theory: Working With InlineData, MemberData, ClassData](https://hamidmosalla.com/2017/02/25/xunit-theory-working-with-inlinedata-memberdata-classdata/).

As you can see in that post, some popular attributes are:

- InlineDataAttribute
- PropertyDataAttribute
- ClassDataAttribute

AutoFixture.Xunit extension includes a very useful type, for providing
auto-data theories,
called
[AutoMoqDataAttribute](http://blog.ploeh.dk/2010/10/08/AutoDataTheoriesWithAutoFixture.aspx "AutoData Theories with AutoFixture").

## Context

Imagine a scenario where we have a test method with 3 parameters:

``` csharp
[Theory]
[InlineAutoData("foo")]
[InlineAutoData("foo", "bar")]
public void Test(string s1, string s2, MyClass myClass)
{
    // ...
}
```

We want the first parameters to be supplied by `InlineDataAttribute` and the rest by
AutoFixture using `AutoMoqDataAttribute`.

This is possible using the **InlineAutoDataAttribute** type which is
now on the trunk and will be available on next public release (after
AutoFixture version 2.1).

## How it works

InlineAutoDataAttribute provides a data source for a data theory, with the data
coming from inline values combined with auto-generated data generated by AutoFixture.

InlineAutoDataAttribute derives from **CompositeDataAttribute**, an
implementation of DataAttribute that composes other DataAttributes.

The implementation turns out to be a bit tricky:

  - Delegate the GetData method call to the *first* attribute.
  - Loop through the results from the first attribute and check if the
    length of each object array matches the number of arguments required
    by the method.
      - If so, yield the object array.
      - If not, invoke GetData on the *next* attribute.
          - Throw away the first objects from the result in order to
            continue from where it ran out of objects from the first
            result set and concatenate the rest to the previous array.
  - Recursively repeat this process until all object arrays have the
    required length.

While this feature comes with AutoFixture.Xunit extension, the
CompositeDataAttribute class depends only on the xunit.extensions
assembly.
